<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <script src="src/libs/marked.min.js"></script>
    <link rel="preconnect" href="https://rsms.me/">
    <link rel="stylesheet" href="https://rsms.me/inter/inter.css">
    <link rel="stylesheet" href="src/index.css">
    <title>Gr√ºtziü§ù</title>
</head>
<body>
    <div id="menu"></div>
    <div id="content"></div>
    <div id="background"></div>
    <script>
        fetch('/media/content.md')
        .then(content => content.text())
        .then(content => {
            let sites = content.split('------')
            sites.map((site,siteIndex) => {
                let wrapper = document.createElement('div')
                let siteArray = site.split('<-images->')
                if(siteArray.length > 1){
                    site = siteArray[0]
                    let images = document.createElement('div')
                    images.classList.add('images')
                    images.innerHTML = siteArray[1]
                    wrapper.appendChild(images)
                }
                //content
                let html = marked.parse(site)
                let div = document.createElement('div')
                div.classList.add('text')
                div.innerHTML = html
                wrapper.prepend(div)

                document.getElementById('content').appendChild(wrapper)
                document.getElementById('content').appendChild(document.createElement('br'))
                document.getElementById('content').appendChild(document.createElement('hr'))
                //menu
                let h1 = div.getElementsByTagName('h1')[0]
                h1.id = h1.innerHTML.toLocaleLowerCase().replaceAll(' ', '-')
                let a = document.createElement('a')
                a.href = '#' + h1.id
                a.innerHTML = siteIndex > 0 ? "‚á¢ "+h1.innerHTML:h1.innerHTML
                document.getElementById('menu').appendChild(a)
            }) 
            let a = document.createElement('a')
            a.href = '/src/impressum.html'
            a.innerHTML = 'Impressum'
            document.getElementById('menu').appendChild(a)
            document.querySelectorAll('img').forEach(img => {
                img.addEventListener('click', enlargeImage)
            })
        })

        function showMenu(){
            document.getElementById("burgerOpen").style.visibility = "hidden"
            document.getElementById("burgerClose").style.visibility = "visible"
            document.getElementById("menu").style.visibility = "visible"
        }       
        function closeMenu(){
            document.getElementById("burgerClose").style.visibility = "hidden"
            document.getElementById("burgerOpen").style.visibility = "visible"
            document.getElementById("menu").style.visibility = "hidden"
        }
        let image = null
        function enlargeImage(event){
            image = event.target
            image.classList.add('enlarged')
            image.addEventListener('click', closeImage)
            document.getElementById('background').style.visibility = 'visible'
        }
        document.addEventListener('keydown', (event) => {
            if(event.key == 'Escape'){
                closeImage()
            }
        })
        document.addEventListener('scroll', (event) => {
            closeImage()
        })
        function closeImage(){
            if(image == null) return
            document.getElementById('background').style.visibility = 'hidden'
            image.classList.remove('enlarged')
            image.removeEventListener('click', closeImage)
            image = null
        }
    </script>
    
</body>
</html>