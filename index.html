<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="src/libs/marked.min.js"></script>
    <link rel="stylesheet" href="src/index.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Arimo:ital,wght@0,400..700;1,400..700&family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap"
        rel="stylesheet">
    <meta property="og:title" content="Philipp Proff">
    <meta property="og:description" content="This website is the contemporary representation of my works, thoughts and creativity.">
    <meta property="og:image" content="https://philippproff.eu/media/me.png">
    <meta property="og:url" content="https://philippproff.eu/">

    <title>Home</title>
</head>

<body>
    <div id="menu">
        <div id="refs"></div>
        <div id="specs">
            <table>
                <tr>
                    <td>Fonts:</td>
                    <td id="font"></td>
                </tr>
                <tr>
                    <td>Width:</td>
                    <td id="width"></td>
                </tr>
                <tr>
                    <td>Height:</td>
                    <td id="height"></td>
                </tr>
                <tr>
                    <td>Time:</td>
                    <td id="time"></td>
                </tr>
            </table>

        </div>
    </div>
    <div id="content"></div>
    <div id="background"></div>
    <footer>
        <a href="/src/impressum.html" target="_blank">Impressum</a>
        <a href="https://www.are.na/philipp-proff/channels" target="_blank">Are.na</a>
        <a href="mailto:philipp.proff@gmx.de" target="_blank">E-Mail</a>
    </footer>
    <script>
        fetch('/src/content.md')
            .then(content => content.text())
            .then(content => {
                let sites = content.split('------')
                sites.map((site, siteIndex) => {
                    let components = site.split('---');
                    let content = document.createElement('div')
                    //content
                    let text = marked.parse(components[0])
                    let textElement = document.createElement('div')
                    textElement.classList.add('text')
                    textElement.innerHTML = text
                    content.prepend(textElement)
                    document.getElementById('content').appendChild(content)
                    let title = textElement.querySelector('h3')
                    title.id = title.innerHTML.toLocaleLowerCase().replaceAll(' ', '-')

                    //menu
                    let menuElement = document.createElement('a')
                    menuElement.href = '#' + title.id
                    menuElement.innerHTML = siteIndex > 0 ? "⇢ " + title.innerHTML : title.innerHTML
                    document.getElementById('refs').appendChild(menuElement)

                    let media = document.createElement('div')
                    document.getElementById('content').appendChild(media)

                    let toggleElement = document.createElement('span')
                    toggleElement.innerHTML = "[–]"
                    toggleElement.classList.add('toggleElement')
                    content.appendChild(toggleElement)

                    let mediaElement = document.createElement('div')
                    mediaElement.classList.add('media')
                    mediaElement.classList.add('visible')
                    media.appendChild(mediaElement)

                    toggleElement.addEventListener('click', (event) => {
                        mediaElement.classList.toggle('visible')
                        event.target.innerHTML = mediaElement.classList.contains('visible') ? "[–]" : "[+]"
                    })

                    if (components.length > 1) {
                        let tags = components[1]
                        let tagsElement = document.createElement('div')
                        tagsElement.classList.add('tags')
                        tagsElement.innerHTML = tags
                        mediaElement.appendChild(tagsElement)
                        if (components.length > 2) {
                            //images
                            let images = components[2]
                            let imagesElement = document.createElement('div')
                            imagesElement.classList.add('images')
                            imagesElement.innerHTML = images
                            mediaElement.appendChild(imagesElement)
                        }
                    }
                })
                //make all images enlargeable
                document.querySelectorAll('img').forEach(img => {
                    img.addEventListener('click', enlargeImage)
                })
                document.querySelectorAll('#content a').forEach(a => {
                    a.target = "_blank"
                })
            })

        //specs
        document.getElementById('font').innerHTML = window.getComputedStyle(document.querySelector('#content'),null).getPropertyValue('font-family') + "<br>" + window.getComputedStyle(document.querySelector('#menu'),null).getPropertyValue('font-family')
        document.getElementById('width').innerHTML = window.innerWidth + "px"
        document.getElementById('height').innerHTML = window.innerHeight + "px"
        document.getElementById('time').innerHTML =  new Date().toLocaleString("de-DE",{timeZone: 'Europe/Berlin'})
        setInterval(() => {
            document.getElementById('time').innerHTML =  new Date().toLocaleString("de-DE",{timeZone: 'Europe/Berlin'})
        }, 1000)
        window.addEventListener('resize', () => {
            document.getElementById('width').innerHTML = window.innerWidth + "px"
            document.getElementById('height').innerHTML = window.innerHeight + "px"
        })
        //enlarge images
        let image = null
        document.addEventListener('keydown', closeImage)
        document.addEventListener('scroll', (e) => { if (image != null) e.preventDefault() })
        function enlargeImage(event) {
            image = event.target
            image.classList.add('enlarged')
            image.addEventListener('click', closeImage)
            document.getElementById('background').style.visibility = 'visible'
        }
        function closeImage() {
            if (image == null) return
            document.getElementById('background').style.visibility = 'hidden'
            image.classList.remove('enlarged')
            image.removeEventListener('click', closeImage)
            image = null
        }
    </script>

</body>

</html>